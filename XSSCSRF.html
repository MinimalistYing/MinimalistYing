<!DOCTYPE html><html><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
	<meta name="baidu-site-verification" content="e7Xf8PjkZ4">
	<meta name="description" content="小影子的博客，记录工作经验，分享前端技术~">
	<meta name="keyword" content="博客 前端 技术 Blog FrontEnd Experience">
	<title>MinimalistYing.io</title>
	<script charset="utf-8" src="https://hmcdn.baidu.com/static/tongji/plugins/UrlChangeTracker.js"></script><script src="https://hm.baidu.com/hm.js?a3319bfaaf51660db9fb0bbf68d309cb"></script><script>
		var _hmt = _hmt || [];
		(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?a3319bfaaf51660db9fb0bbf68d309cb";
			var s = document.getElementsByTagName("script")[0]; 
			s.parentNode.insertBefore(hm, s);
		})();
	</script>
<link rel="shortcut icon" href="favicon.ico"><link href="main.ba348b966d7b4dc69e1d.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="0.ef1bd9dbce806a540650.css"><script charset="utf-8" src="0.e3fc404a03ea51474c0f.bundle.js"></script><script charset="utf-8" src="5.4749751c69454854f14e.bundle.js"></script><link rel="stylesheet" type="text/css" href="2.41696c5507cad7d5f341.css"><script charset="utf-8" src="2.510b9aa996f2336192b4.bundle.js"></script></head>
<body>
	<div id="app"><div><header><h3 class="header-title">MinimalistYing.io</h3><nav><ul><li><a href="/index.html">博客</a></li><li><a href="/memo.html">备忘</a></li><li><a href="https://codepen.io/MinimalistYing" target="_blank">代码库</a></li><li><a href="https://leetcode.com/MinimalistYing" target="_blank">Leetcode</a></li><li><a href="https://stackoverflow.com/users/8459774/minimalistying" target="_blank">StackOverflow</a></li><li><a href="https://github.com/MinimalistYing" target="_blank">Github</a></li></ul></nav></header><div class="blogs"><div class="blog"><div class="my-md"><h1 id="-xss-csrf">关于 XSS 以及 CSRF</h1>
<h2 id="xss-cross-site-scripting-">XSS (Cross-Site Scripting)</h2>
<h3 id="-">攻击原理</h3>
<p>利用网站对用户输入的信任进行攻击<br>假设一个博客网站将用户的输入不经转义直接存入数据库，又原封不动的将数据库的内容插入页面中展示<br>这时候如果恶意用户在发布的一篇博文中加入了的一串脚本代码</p>
<pre><code class="language-html">博客正文内容...
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// 恶意脚本 窃取用户信息 跳转恶意网站 修改页面显示内容</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
<p>当其余用户浏览该篇博文时，由于未经过任何转义，恶意脚本和正文一起被插入页面的 DOM 节点中<br>脚本中的代码随即被浏览器加载执行，也就形成了一次 XSS 攻击</p>
<h3 id="-">防范方法</h3>
<p>不信任任何用户的输入，对所有用户输入进行转义后才存入数据库<br>所有用户输入的内容先进行转义再插入相应 DOM 节点<br>React/Vue/Angular 等前端框架大多都默认进行了转义处理<br>例如在 React 中需要使用 <code>dangerouslySetInnerHTML={}</code> Vue 中需要使用 <code>v-html</code> 来插入未转义的内容<br>这些默认行为有时会使得开发者忽视掉防范 XSS 攻击，只要足够小心这类攻击其实可以被完全杜绝<br>此外，将 Cookie 设为 <code>HttpOnly</code> 可以阻止进行 XSS 攻击的恶意脚本获取存储在 Cookie 中的敏感信息</p>
<h2 id="csrf-cross-site-request-forgery-">CSRF (Cross-Site Request Forgery)</h2>
<h3 id="-">攻击原理</h3>
<p>假设用户在登录了 <code>www.bank.com</code> 的同时打开了 <code>www.evil.com</code><br>而攻击者恰好知道转账的接口为 <code>http://www.bank.com/transfer?to=AcountId&amp;amount=99999</code><br>这时候攻击者在 <code>www.evil.com</code> 的页面上隐藏了一个标签 <code>&lt;img src="www.bank.com/transfer?to=AcountId&amp;amount=99999" style="display: none"&gt;</code><br>如果银行网站恰好仅仅简单的利用 Cookie 进行用户校验（当然大部分情况下银行网站不会这么傻）<br>由于 <code>&lt;img&gt;</code> 的 <code>src</code> 属性可以绕开 Same-Origin Policy 的限制进行跨域请求<br>所以这个 GET 请求会正确发送并且携带上用户登录信息的相关 Cookie ，成功将钱转到了攻击者的账号  </p>
<h3 id="-">防范方法</h3>
<ul>
<li>合理的设计 API ，GET 请求不应该进行会造成 Side Effect 的操作</li>
<li>利用 CSRF-Token 在每次请求时需要携带 Token 来校验权限</li>
<li>在进行转账、支付等危险操作时需要再次输入密码（像支付宝、银行等应用的密码就会分为登录密码和付款密码）</li>
</ul>
</div></div><div id="category" class="category-box"><ul class="blogs-category"><li id="MoesifBug" class="">记一次 Chrome 更新导致插件故障引发的问题</li><li id="Frameworks" class="">关于前端框架选型的一些思考</li><li id="LowDesireSociety" class="">观后感：《低欲望社会》大前研一</li><li id="Cascading" class="">浅谈 CSS（Cascading Style Sheets) 之层叠</li><li id="Axios" class="">Axios 源码解析</li><li id="VueVsReact" class="">React 与 Vue 的一些对比</li><li id="WhyPreflight" class="">为什么 CORS 需要在跨域请求前进行预校验 (Preflight)</li><li id="ArraySort" class="">Array.prototype.sort() 在使用默认 CompareFn 时的问题</li><li id="BinaryTreeType" class="">常见的二叉树类型</li><li id="Ajax" class="">Ajax (Asynchronous JavaScript And XML)</li><li id="XSSCSRF" class="selected">关于 XSS 以及 CSRF</li><li id="CookieAndWebStorage" class="">Cookie 和 WebStorage</li><li id="CrossOrigin" class="">关于跨域</li><li id="WebpackCommonProblem" class="">记录配置 Webpack 过程中碰到的问题以及解决方案</li><li id="SourceMapAndWebpack" class="">关于 Source Map 以及 Webpack 中 Devtool 的相关配置</li><li id="BinaryTreeTraversal" class="">二叉树的遍历</li><li id="ReactRedux" class="">React-Redux 从入门到后悔</li><li id="Redux" class="">Redux 从入门到放弃</li><li id="PreventModalScroll" class="">如何阻止模态框 (Modal / Popup / Dialog) 弹出后 Body 可滚动</li><li id="PromiseBlog" class="">Promise In ES6</li><li id="Collections" class="">New Collections In ES6</li><li id="ObjectAPI" class=""> Object's New API In ES6</li><li id="ArrayAPI" class="">Array's New API In ES6</li><li id="Generator" class="">Generator in ES6</li><li id="WebpackV3ToV4" class="">Webpack V3 升级至 V4</li><li id="IteratorBlog" class="">Iterator in ES6</li><li id="SymbolBlog" class="">Symbols in ES6</li><li id="GulpPlugin" class="">如何编写一个自己的GulpPlugin</li><li id="WebpackBaseConfig" class="">Webpack(v3.8.1)</li></ul></div><div class="category-toggle"></div></div></div></div>
<script type="text/javascript" src="main.a4334adb117015217671.js"></script>
</body></html>